<div class="container-fluid">
    <div class="row">
        <!-- Main Dashboard Content -->
        <div class="col-lg-8">
            <div class="d-flex justify-content-between align-items-center mb-4 px-3 pt-3">
                <div>
                    <h2 class="fw-bold mb-1">Today's Tracker</h2>
                    <p class="text-muted mb-0"><%= new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) %></p>
                </div>
                <div class="text-center">
                    <div class="position-relative d-inline-block">
                        <canvas id="progressChart" width="80" height="80"></canvas>
                        <div class="position-absolute top-50 start-50 translate-middle text-center">
                            <h4 class="mb-0 text-primary fw-bold" id="completionPercentage">0%</h4>
                            <small class="text-muted">Complete</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Time Slot Sections -->
            <div class="px-3">
                <!-- Morning Section -->
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <div class="d-flex align-items-center">
                            <div class="bg-warning rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 24px; height: 24px;">
                                <i class="fas fa-sun text-white" style="font-size: 12px;"></i>
                            </div>
                            <h6 class="mb-0 fw-bold">Morning</h6>
                            <span class="badge bg-light text-dark ms-2" id="morning-count">2 of 4 completed</span>
                        </div>
                        <button class="btn btn-link btn-sm text-primary p-0" onclick="showAddActivityModal('morning')">
                            + Add Activity
                        </button>
                    </div>
                    <div id="morning-activities">
                        <!-- Activities will be loaded here -->
                    </div>
                </div>

                <!-- Afternoon Section -->
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 24px; height: 24px;">
                                <i class="fas fa-sun text-white" style="font-size: 12px;"></i>
                            </div>
                            <h6 class="mb-0 fw-bold">Afternoon</h6>
                            <span class="badge bg-light text-dark ms-2" id="afternoon-count">0 of 2 completed</span>
                        </div>
                        <button class="btn btn-link btn-sm text-primary p-0" onclick="showAddActivityModal('afternoon')">
                            + Add Activity
                        </button>
                    </div>
                    <div id="afternoon-activities">
                        <!-- Activities will be loaded here -->
                    </div>
                </div>

                <!-- Evening Section -->
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <div class="d-flex align-items-center">
                            <div class="bg-dark rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 24px; height: 24px;">
                                <i class="fas fa-moon text-white" style="font-size: 12px;"></i>
                            </div>
                            <h6 class="mb-0 fw-bold">Evening</h6>
                            <span class="badge bg-light text-dark ms-2" id="evening-count">1 of 1 completed</span>
                        </div>
                        <button class="btn btn-link btn-sm text-primary p-0" onclick="showAddActivityModal('evening')">
                            + Add Activity
                        </button>
                    </div>
                    <div id="evening-activities">
                        <!-- Activities will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <div class="p-3">
                <!-- Quick Stats -->
                <div class="mb-4">
                    <h6 class="fw-bold mb-3">Quick Stats</h6>
                    <div class="d-flex justify-content-between mb-2">
                        <div class="d-flex align-items-center">
                            <div class="bg-danger rounded-circle me-2" style="width: 8px; height: 8px;"></div>
                            <span class="text-muted">Streak</span>
                        </div>
                        <span class="fw-bold" id="currentStreak">1 days</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <div class="d-flex align-items-center">
                            <div class="bg-success rounded-circle me-2" style="width: 8px; height: 8px;"></div>
                            <span class="text-muted">This Week</span>
                        </div>
                        <span class="fw-bold" id="weeklyAverage">43%</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <div class="d-flex align-items-center">
                            <div class="bg-info rounded-circle me-2" style="width: 8px; height: 8px;"></div>
                            <span class="text-muted">Total Activities</span>
                        </div>
                        <span class="fw-bold" id="totalActivities">3</span>
                    </div>
                </div>

                <!-- Activity Library -->
                <div class="mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6 class="fw-bold mb-0">Activity Library</h6>
                        <a href="#" class="text-primary text-decoration-none small">View All</a>
                    </div>
                    <div id="activityLibrary">
                        <div class="d-flex justify-content-between align-items-center mb-2 p-2 bg-light rounded">
                            <div class="d-flex align-items-center">
                                <div class="bg-danger rounded-circle me-2" style="width: 8px; height: 8px;"></div>
                                <span class="small">30-min Walk</span>
                            </div>
                            <button class="btn btn-link btn-sm p-0">+</button>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2 p-2 bg-light rounded">
                            <div class="d-flex align-items-center">
                                <div class="bg-primary rounded-circle me-2" style="width: 8px; height: 8px;"></div>
                                <span class="small">8 Hours Sleep</span>
                            </div>
                            <button class="btn btn-link btn-sm p-0">+</button>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2 p-2 bg-light rounded">
                            <div class="d-flex align-items-center">
                                <div class="bg-success rounded-circle me-2" style="width: 8px; height: 8px;"></div>
                                <span class="small">Drink 8 Glasses Water</span>
                            </div>
                            <button class="btn btn-link btn-sm p-0">+</button>
                        </div>
                    </div>
                    <button class="btn btn-primary w-100 mt-3" onclick="showAddActivityModal('custom')">
                        + Create Custom Activity
                    </button>
                </div>

                <!-- Admin Panel (if admin) -->
                <% if (user && user.role === 'admin') { %>
                <div class="bg-gradient text-white p-3 rounded" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h6 class="fw-bold mb-3 text-white">Admin Panel</h6>
                    <div class="d-grid gap-2">
                        <a href="/admin" class="btn btn-light btn-sm">
                            <i class="fas fa-users me-1"></i> Manage Users
                        </a>
                        <a href="/admin" class="btn btn-light btn-sm">
                            <i class="fas fa-cog me-1"></i> Manage Activities
                        </a>
                        <a href="/admin" class="btn btn-light btn-sm">
                            <i class="fas fa-chart-line me-1"></i> View Analytics
                        </a>
                    </div>
                </div>
                <% } %>
            </div>
        </div>
    </div>
</div>

<!-- Add Activity Modal -->
<div class="modal fade" id="addActivityModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Activity</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="addActivityForm">
                    <div class="mb-3">
                        <label for="activitySelect" class="form-label">Choose Activity</label>
                        <select class="form-select" id="activitySelect" name="activityId">
                            <option value="">Loading activities...</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label for="timeSlot" class="form-label">Time Slot</label>
                        <select class="form-select" id="timeSlot" name="timeSlot">
                            <option value="morning">Morning</option>
                            <option value="afternoon">Afternoon</option>
                            <option value="evening">Evening</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="createCustom">
                            <label class="form-check-label" for="createCustom">
                                Create custom activity
                            </label>
                        </div>
                    </div>
                    
                    <div id="customActivityFields" style="display: none;">
                        <div class="mb-3">
                            <label for="customTitle" class="form-label">Activity Name</label>
                            <input type="text" class="form-control" id="customTitle" name="customTitle">
                        </div>
                        
                        <div class="mb-3">
                            <label for="customDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="customDescription" name="customDescription" rows="3"></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label for="customCategory" class="form-label">Category</label>
                            <select class="form-select" id="customCategory" name="customCategory">
                                <option value="workout">Workout</option>
                                <option value="nutrition">Nutrition</option>
                                <option value="recovery">Recovery</option>
                                <option value="mindset">Mindset</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addActivity()">Add Activity</button>
            </div>
        </div>
    </div>
</div>